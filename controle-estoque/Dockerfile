FROM openjdk:17
ARG PROFILE
ARG CONTROLE_ESTOQUE_JPA_DDL-AUTO
ARG CONTROLE_ESTOQUE_JDBC_URL
ARG CONTROLE_ESTOQUE_JDBC_USERNAME
ARG CONTROLE_ESTOQUE_JDBC_PASSWORD
ARG CONTROLE_ESTOQUE_JPA_SHOW-SQL
ARG CONTROLE_ESTOQUE_SYSTEM_USERNAME
ARG CONTROLE_ESTOQUE_SYSTEM_INITIAL
ARG CONTROLE_ESTOQUE_SYSTEM_SIZE-PER-PAGE
ARG CONTROLE_ESTOQUE_ADMINISTRATOR_NAME
ARG CONTROLE_ESTOQUE_ADMINISTRATOR_EMAIL
ARG CONTROLE_ESTOQUE_ADMINISTRATOR_LOGIN
ARG CONTROLE_ESTOQUE_ADMINISTRATOR_PASSWORD


ENV PROFILE $PROFILE
ENV MAIL_USERNAME $MAIL_USERNAME
ENV MAIL_PASSWORD $MAIL_PASSWORD
ENV CONTROLE_ESTOQUE_JPA_DDL-AUTO $CONTROLE_ESTOQUE_JPA_DDL-AUTO
ENV CONTROLE_ESTOQUE_JDBC_URL $CONTROLE_ESTOQUE_JDBC_URL
ENV CONTROLE_ESTOQUE_JDBC_USERNAME $CONTROLE_ESTOQUE_JDBC_USERNAME
ENV CONTROLE_ESTOQUE_JDBC_PASSWORD $CONTROLE_ESTOQUE_JDBC_PASSWORD
ENV CONTROLE_ESTOQUE_JPA_SHOW-SQL $CONTROLE_ESTOQUE_JPA_SHOW-SQL
ENV CONTROLE_ESTOQUE_SYSTEM_USERNAME $CONTROLE_ESTOQUE_SYSTEM_USERNAME
ENV CONTROLE_ESTOQUE_SYSTEM_INITIAL $CONTROLE_ESTOQUE_SYSTEM_INITIAL
ENV CONTROLE_ESTOQUE_SYSTEM_SIZE-PER-PAGE $CONTROLE_ESTOQUE_SYSTEM_SIZE-PER-PAGE
ENV CONTROLE_ESTOQUE_ADMINISTRATOR_NAME $CONTROLE_ESTOQUE_ADMINISTRATOR_NAME
ENV CONTROLE_ESTOQUE_ADMINISTRATOR_EMAIL $CONTROLE_ESTOQUE_ADMINISTRATOR_EMAIL
ENV CONTROLE_ESTOQUE_ADMINISTRATOR_LOGIN $CONTROLE_ESTOQUE_ADMINISTRATOR_LOGIN
ENV CONTROLE_ESTOQUE_ADMINISTRATOR_PASSWORD $CONTROLE_ESTOQUE_ADMINISTRATOR_PASSWORD

RUN mkdir /app

COPY target/*.jar /app/app.jar

WORKDIR /app

CMD java \
    -Dspring.profiles.active=$PROFILE \
    -DJava.awt.headless=true \
    -Dspring.mail.username=$MAIL_USERNAME \
    -Dspring.mail.password=$MAIL_PASSWORD \
    -Dspring.datasource.username=$CONTROLE_ESTOQUE_JDBC_USERNAME \
    -Dspring.datasource.password=$CONTROLE_ESTOQUE_JDBC_PASSWORD \
    -Ddefault.system.username=$CONTROLE_ESTOQUE_SYSTEM_USERNAME \
    -Ddefault.system.initial-page=$CONTROLE_ESTOQUE_SYSTEM_INITIAL-PAGE \
    -Ddefault.system.size-per-page=$CONTROLE_ESTOQUE_SYSTEM_SIZE-PER-PAGE \
    -Ddefault.system.user.administrator.name=$CONTROLE_ESTOQUE_ADMINISTRATOR_NAME \
    -Ddefault.system.user.administrator.email=$CONTROLE_ESTOQUE_ADMINISTRATOR_EMAIL \
    -Ddefault.system.user.administrator.login=$CONTROLE_ESTOQUE_ADMINISTRATOR_LOGIN \
    -Ddefault.system.user.administrator.password=$CONTROLE_ESTOQUE_ADMINISTRATOR_PASSWORD \
    -jar \
    -Xms516m \
    -Xmx516m \
    /app/app.jar

EXPOSE 8081
